"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const stream_1 = require("stream");
class ResultBuilder {
    constructor() {
        this.responseHeaders = {};
    }
    /**
     * Add header to the action response
     * @param name the header name
     * @param value the header value
     * @example
     * .setHeader('myHeaderName', 'my header value');
     */
    setHeader(name, value) {
        this.responseHeaders[name] = value;
        return this;
    }
    /**
     * Returns a success response from the action
     * @param message the success message to return
     * @param options available options to return
     * @example
     * .success('Success', { html: '<blinkee>Success!</blinkee>' });
     */
    success(message, options) {
        return {
            type: 'Success',
            message: message ?? '',
            invalidated: new Set(options?.invalidated ?? []),
            html: options?.html,
            responseHeaders: this.responseHeaders,
        };
    }
    /**
     * Returns an error response from the action
     * @param message the error message to return
     * @param options available options to return
     * @example
     * .error('Failed to refund the customer!', { html: '<strong>Error!</strong>' });
     */
    error(message, options) {
        return {
            type: 'Error',
            message: message ?? 'Error',
            html: options?.html,
            responseHeaders: this.responseHeaders,
        };
    }
    /**
     * Returns a webhook that the UI will trigger
     * @param url the url of the webhook
     * @param method the HTTP method of the webhook
     * @param headers an object representing the list of headers to send with the webhook
     * @param body an object representing the body of the HTTP request
     * @example
     * .webhook('http://my-company-name', 'POST', {}, { adminToken: 'my-admin-token' });
     */
    webhook(url, method = 'POST', headers = {}, body = {}) {
        return {
            type: 'Webhook',
            url,
            method,
            headers,
            body,
            responseHeaders: this.responseHeaders,
        };
    }
    /**
     * Returns a file that will be downloaded
     * @param streamOrBufferOrString the actual file to download
     * @param name the name of the file
     * @param mimeType the mime type of the file
     * @example
     * .file('This is my file content', 'download.txt', 'text/plain');
     */
    file(streamOrBufferOrString, name = 'file', mimeType = 'application/octet-stream') {
        return {
            type: 'File',
            name,
            mimeType,
            stream: streamOrBufferOrString instanceof stream_1.Readable
                ? streamOrBufferOrString
                : stream_1.Readable.from([streamOrBufferOrString]),
            responseHeaders: this.responseHeaders,
        };
    }
    /**
     * Returns to the UI that a redirection is needed
     * @param path the path to redirect to
     * @example
     * .redirectTo('https://www.google.com');
     */
    redirectTo(path) {
        return { type: 'Redirect', path, responseHeaders: this.responseHeaders };
    }
}
exports.default = ResultBuilder;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVzdWx0LWJ1aWxkZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvZGVjb3JhdG9ycy9hY3Rpb25zL3Jlc3VsdC1idWlsZGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQ0EsbUNBQWtDO0FBRWxDLE1BQXFCLGFBQWE7SUFBbEM7UUFDVSxvQkFBZSxHQUFrQixFQUFFLENBQUM7SUEyRzlDLENBQUM7SUF6R0M7Ozs7OztPQU1HO0lBQ0gsU0FBUyxDQUFDLElBQVksRUFBRSxLQUFhO1FBQ25DLElBQUksQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLEdBQUcsS0FBSyxDQUFDO1FBRW5DLE9BQU8sSUFBSSxDQUFDO0lBQ2QsQ0FBQztJQUVEOzs7Ozs7T0FNRztJQUNILE9BQU8sQ0FBQyxPQUFnQixFQUFFLE9BQW1EO1FBQzNFLE9BQU87WUFDTCxJQUFJLEVBQUUsU0FBUztZQUNmLE9BQU8sRUFBRSxPQUFPLElBQUksRUFBRTtZQUN0QixXQUFXLEVBQUUsSUFBSSxHQUFHLENBQUMsT0FBTyxFQUFFLFdBQVcsSUFBSSxFQUFFLENBQUM7WUFDaEQsSUFBSSxFQUFFLE9BQU8sRUFBRSxJQUFJO1lBQ25CLGVBQWUsRUFBRSxJQUFJLENBQUMsZUFBZTtTQUN0QyxDQUFDO0lBQ0osQ0FBQztJQUVEOzs7Ozs7T0FNRztJQUNILEtBQUssQ0FBQyxPQUFnQixFQUFFLE9BQTBCO1FBQ2hELE9BQU87WUFDTCxJQUFJLEVBQUUsT0FBTztZQUNiLE9BQU8sRUFBRSxPQUFPLElBQUksT0FBTztZQUMzQixJQUFJLEVBQUUsT0FBTyxFQUFFLElBQUk7WUFDbkIsZUFBZSxFQUFFLElBQUksQ0FBQyxlQUFlO1NBQ3RDLENBQUM7SUFDSixDQUFDO0lBRUQ7Ozs7Ozs7O09BUUc7SUFDSCxPQUFPLENBQ0wsR0FBVyxFQUNYLFNBQXlCLE1BQU0sRUFDL0IsVUFBa0MsRUFBRSxFQUNwQyxPQUFnQixFQUFFO1FBRWxCLE9BQU87WUFDTCxJQUFJLEVBQUUsU0FBUztZQUNmLEdBQUc7WUFDSCxNQUFNO1lBQ04sT0FBTztZQUNQLElBQUk7WUFDSixlQUFlLEVBQUUsSUFBSSxDQUFDLGVBQWU7U0FDdEMsQ0FBQztJQUNKLENBQUM7SUFFRDs7Ozs7OztPQU9HO0lBQ0gsSUFBSSxDQUNGLHNCQUFzRCxFQUN0RCxJQUFJLEdBQUcsTUFBTSxFQUNiLFFBQVEsR0FBRywwQkFBMEI7UUFFckMsT0FBTztZQUNMLElBQUksRUFBRSxNQUFNO1lBQ1osSUFBSTtZQUNKLFFBQVE7WUFDUixNQUFNLEVBQ0osc0JBQXNCLFlBQVksaUJBQVE7Z0JBQ3hDLENBQUMsQ0FBQyxzQkFBc0I7Z0JBQ3hCLENBQUMsQ0FBQyxpQkFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLHNCQUFzQixDQUFDLENBQUM7WUFDN0MsZUFBZSxFQUFFLElBQUksQ0FBQyxlQUFlO1NBQ3RDLENBQUM7SUFDSixDQUFDO0lBRUQ7Ozs7O09BS0c7SUFDSCxVQUFVLENBQUMsSUFBWTtRQUNyQixPQUFPLEVBQUUsSUFBSSxFQUFFLFVBQVUsRUFBRSxJQUFJLEVBQUUsZUFBZSxFQUFFLElBQUksQ0FBQyxlQUFlLEVBQUUsQ0FBQztJQUMzRSxDQUFDO0NBQ0Y7QUE1R0QsZ0NBNEdDIn0=